<!DOCTYPE html>

<html lang="en">
    <head>
        <title>Login</title>
        <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0">

        <script>
            function sendLoginRequest() {
                let username = document.getElementById("username").value;
                let password = document.getElementById("password").value;

                try {
                    const syncRequest = new XMLHttpRequest();
                    syncRequest.open("POST", "login.php", false);
                    syncRequest.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
                    syncRequest.send(`username=${username}&password=${password}`);

                    if (syncRequest.status === 200) {
                        document.body.innerHTML = syncRequest.responseText;
                        let scripts = document.body.getElementsByTagName("script");

                        if (scripts.length > 0) {
                            eval(scripts[0].text); // execute the declaration code for our returned functions so that the browser knows they exist
                            save_ticket_in_cookie(); // create a cookie on the user's browser with their ticket number
                            redirect(); // redirect to the user's dashboard
                        }
                    }
                }
                catch (exception) {
                    alert("Request failed. Please try again.");
                }


            }
        </script>
    </head>

    <body>
        <form>
            Username: <input id="username" type="text" name="username"><br>
            Password: <input id="password" type="password" name="password"><br>
            <button type="button" onclick="sendLoginRequest()">Login</button>
        </form>

        <a href="register.html">
            <button>Register</button>
         </a>
    </body>
</html>